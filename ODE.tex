\documentclass[oneside]{book} %oneside消除奇偶页出现的空页问题，页眉也会随之改变
\usepackage[zihao=-4]{ctex} %引入中文宏包
\usepackage{ulem}%提供\uline命令引入高低一致的下划线
\usepackage{amsmath}%数学公式排版
\usepackage{amssymb}%用命令 \mathbb
\usepackage{geometry}%编辑页面边距
\usepackage{pifont}%编辑带圈数字
\usepackage{fancyhdr}%风格,页眉页脚
\usepackage[backref]{hyperref}%超链接
\usepackage{color}%字体颜色
\usepackage{extarrows}%输入带文字的长等号
\usepackage[dvipsnames,svgnames]{xcolor}
\usepackage[strict]{changepage} % 提供一个 adjustwidth 环境
\usepackage{framed} % 实现方框效果
\usepackage{amsthm}

\usepackage{tikz}
\usetikzlibrary{mindmap,trees}
\usepackage{verbatim}


\hypersetup{colorlinks=true,linkcolor=cyan,anchorcolor=megenta,citecolor=yellow}
\geometry{right=2.5cm,left=2.5cm,top=2.5cm,bottom=2.5cm}
\renewcommand{\headrulewidth}{0pt}%去掉页眉分划
\pagestyle{fancy}
\fancyhead[L]{}
\fancyhead[R]{\rightmark}

% ------------------******-------------------
\newtheorem{lemma}{推论}[section]  %推论
% environment derived from framed.sty: see leftbar environment definition
\definecolor{lashade}{rgb}{0.97,0.96,0.99} % 方框底部颜色
% ------------------******-------------------
% 注意行末需要把空格注释掉，不然画出来的方框会有空白竖线
\newenvironment{la}{%
\def\FrameCommand{%
\hspace{1pt}%
{\color{RoyalPurple}\vrule width 2pt}%竖线颜色
{\color{lashade}\vrule width 4pt}%
\colorbox{lashade}%
}%
\MakeFramed{\advance\hsize-\width\FrameRestore}%
\noindent\hspace{-4.55pt}% disable indenting first paragraph
\begin{adjustwidth}{}{7pt}%
\vspace{2pt}\vspace{2pt}%
\normalfont %环境字体设置
}
{%
\vspace{2pt}\end{adjustwidth}\endMakeFramed%
}

\newtheorem*{example}{例}
\newtheorem{examp}{例}
\definecolor{egshade}{rgb}{0.96,0.96,0.96}% 
\newenvironment{eg}{%
\def\FrameCommand{%
\hspace{1pt}%
{\color{Gray}\vrule width 2pt}%竖线颜色
{\color{egshade}\vrule width 4pt}%
\colorbox{egshade}%
}%
\MakeFramed{\advance\hsize-\width\FrameRestore}%
\noindent\hspace{-4.55pt}% 
\begin{adjustwidth}{}{7pt}%
\vspace{2pt}\vspace{2pt}%
\normalfont %环境字体设置
}
{%
\vspace{2pt}\end{adjustwidth}\endMakeFramed%
}

\newtheorem{definition}{定义}[section]  
\newtheorem{defini}{}
\newtheorem{theorem}{定理}[section]  
\newtheorem{theo}{}  
\definecolor{tdshade}{rgb}{0.94,0.97,0.93} % 
\newenvironment{td}{%
\def\FrameCommand{%
\hspace{1pt}%
{\color{Green}\vrule width 2pt}%竖线颜色
{\color{tdshade}\vrule width 4pt}%
\colorbox{tdshade}%
}%
\MakeFramed{\advance\hsize-\width\FrameRestore}%
\noindent\hspace{-4.55pt}% 
\begin{adjustwidth}{}{7pt}%
\vspace{2pt}\vspace{2pt}%
\normalfont %
}
{%
\vspace{2pt}\end{adjustwidth}\endMakeFramed%
}


\newtheorem{warning}{注}[section]  
\definecolor{washade}{rgb}{0.99,0.95,0.94} % 方框底部颜色
\newenvironment{wa}{%
\def\FrameCommand{%
\hspace{1pt}%
{\color{LightCoral}\vrule width 2pt}%竖线颜色
{\color{washade}\vrule width 4pt}%
\colorbox{washade}%
}%
\MakeFramed{\advance\hsize-\width\FrameRestore}%
\noindent\hspace{-4.55pt}% disable indenting first paragraph
\begin{adjustwidth}{}{7pt}%
\vspace{2pt}\vspace{2pt}%
\normalfont %
}
{%
\vspace{2pt}\end{adjustwidth}\endMakeFramed%
}





% ------------------正文-------------------

\begin{document} 

\tableofcontents %生成目录
% --------------第一章----------------
\chapter{第一章 \ 绪论}
% ---------------1.1----------------        
\section{微分方程概述}
\begin{center} 
    \begin{tikzpicture}
        \path[small mindmap,concept color = red!65,text = black]
            node[concept] {方程}
            [clockwise from=25]
            child[concept color = red!50] 
            {
                node[concept] {未知量（数）}
                [clockwise from=25]
                child [concept color = red!40] 
                { 
                    node[concept] {代数方程} 
                }
                child [concept color = red!40] 
                { 
                    node[concept] {超越方程} 
                }     
            }
            child[concept color = red!50] 
            {
                node[concept] {未知函数}
                [clockwise from=0]
                child [concept color = red!40] 
                { 
                    node[concept] {函数方程} 
                    child [concept color = red!30] 
                    { 
                        node[concept] {微分方程} 
                    }
                }
            };
    \end{tikzpicture}
\end{center}


\indent \textbf{方程：}含有未知量（数）的等式或关系式

\textbf{代数方程：}含有超越数。特点：方程的解为有限个或无限个实数

\textbf{函数方程：}其未知量为函数。特点：方程的解为有限个或无限个函数

\textbf{\textcolor{red}{微分方程：}}自变量、未知函数及函数的导数（或微分）组成的关系式

\textbf{常微分方程：}自变量只有一个时的微分方程

\textbf{偏微分方程：}自变量有多个时的微分方程

\newpage
% ----------------1.2-----------------
\section{基本概念}
\subsubsection{1.阶数}
\noindent \pmb{定义：}在一个微分方程中所出现的未知函数的导数的最高阶数n称为该方程的\textbf{\textcolor{red}{阶}}

一阶微分方程：$n = 1$

高阶微分方程：$n > 1$

\noindent \pmb{基本表示：}

\noindent 一阶常微分方程的一般隐式形式
$$ F(x,y,y') = 0$$
一阶常微分方程的一般显式形式
$$y' = f(x,y)$$
$n$阶隐方程的一般形式
$$ F(x,y,y',\dots,y^{(n)}) = 0$$
$n$阶显方程的一般形式
$$y^{(n)} = f(x,y,y',\dots,y^{(n-1)})$$


\subsubsection{2.线性、非线性}
\noindent \pmb{定义：}若方程的左端为$y$，$\dfrac{dy}{dx}$，$\dots$，$\dfrac{d^n y}{d x^n} $，的一次有理整式，则称它为
线性微分方程，否则，称它为非线性微分方程

\noindent \pmb{一般形式：}
$$a_{0}(x)y^{(n)} + a_{1}(x)y^{(n - 1)} + \dots + a_{n}(x)y = g(x)$$
$$\frac{d^n y}{d x^n} + a_{1}(x)\frac{d^{n-1} y}{d x^{n-1}} + \dots + a_{n -1}(x)\frac{dy}{dx} + a_{n}(x)y = f(x)  $$


\subsubsection{3.解和隐式解}
\noindent \pmb{定义：}若将函数$y = \varphi(x)$代入方程后使微分方程有意义且为恒等式，为方程的\textbf{解};若方程的解是某关系式的隐函数，称这个关系式为该方程
的\textbf{隐式解}。把方程解和隐式解统称为方程的解。

\subsubsection{4.通解和特解}
\noindent \pmb{定义：}$n$阶微分方程的含有$n$个独立的任意常数$c_{1},c_{2},\dots,c_{n}$的解$y = \varphi(x,c_{1},c_{2},\dots,c_{n})$称为$n$阶方程的\textcolor{red}{\textbf{通解}}；常微分方程满足某个初始条件的解称为微分方程的特解

\noindent \pmb{定解条件：}确定微分方程的一个特定的解，给出这个解所必需的条件

\noindent \pmb{初值条件：}对于$n$阶方程$y^{(n)} = f(x,y,y',\dots,y^{(n-1)})$的初值条件可表示为
$$y(x_{0}) = y_{0} \quad y'(x_{0}) = y'_{0} \quad y''(x_{0}) = y''_{0} \quad \dots \quad y^{(n-1)}(x_{0}) = y^{(n-1)}_{0}$$
\pmb{定解问题：}求微分方程满足定解条件的解

\noindent \pmb{初值问题：}当定解问题为初值条件时相应的定解问题
n阶方程初值问题的表示
\[
\begin{cases}
    y^{(n)} = f(x,y,y',\dots,y^{(n-1)}) \\
    y(x_{0}) = y_{0} , y'(x_{0}) = y'_{0} , y''(x_{0}) = y''_{0} , \dots , y^{(n-1)}(x_{0}) = y^{(n-1)}_{0}
\end{cases}\]
一阶和二阶方程初值问题的表示
\[
\begin{cases}
    y' = f(x,y) \\
    y(x_{0}) = y_{0}
\end{cases}
\begin{cases}
    y'' = f(x,y,y') \\
    y(x_{0}) = y_{0} , y'(x_{0}) = y'_{0}
\end{cases}
\]
\pmb{特解：}满足初值条件的解

\subsubsection{5.积分曲线和向量场}
\noindent \pmb{积分曲线：}一阶微分方程$\dfrac{dy}{dx}$的解$y = \varphi(x)$表示$Oxy$平面上的一条曲线；通解$y = \varphi(x,c)$表示平面上的一族曲线，称为\textbf{积分曲线族}；特解$\varphi(x_{0}) = y_{0}$则为过点$(x_{0},y_{0})$的一条积分曲线

\noindent \pmb{方向场(向量场)：}$f(x , y) = \dfrac{dy}{dx}$在$Oxy$平面某区域$D$上定义过各点的小线段的斜率方向，这样的区域$D$称为向量场

\noindent \pmb{常微分方程求解的几何意义：}在方向场中寻求一条曲线，使这条曲线上每一点切线的方向等于方向场中该点的方向

\subsubsection{6.计算举例}
已知$S = S(t)$$S' = S'(t)$
\begin{align*}
    \dfrac{d^{2}s}{d t^{2}} & = g \quad \quad \quad \quad \quad \quad \Rightarrow 
    \dfrac{d^{2}s}{d t^{2}} = \dfrac{dS'}{dt} = g \\
    dS' & = g dt \quad \quad \quad \quad \quad \Rightarrow 
    \int dS' = \int g dt \quad \quad \quad \quad \quad \Rightarrow 
    S' = gt + C_{1} \quad \quad \Rightarrow
    \dfrac{dS}{dt} = gt + C_{1} \\
    dS & = (gt + C_{1}) dt \quad \ \Rightarrow 
    \int dS = \int (gt + C_{1}) dt \quad \quad \Rightarrow 
    S = \dfrac{1}{2} gt^{2} + C_{1} + C_{2}
\end{align*}


% -------------------第二章-------------------
\chapter{第二章 \ 一阶微分方程的初等解法}
% ------------------2.1---------------------
\section{变量分离方程与变量变换}
\subsection*{变量分离方程}

\noindent \textbf{定义：}形如$\dfrac{dy}{dx} = f(x) \varphi(y)$的方程，$f(x)$，$\varphi(y)$分别是$x$，$y$的连续函数

\noindent \textbf{求解步骤：}

\ding{172}若$\varphi(y) \neq 0$，则有
$$\frac{dy}{\varphi(y)} = f(x)dx$$
\indent 两边同时积分得
$$\int \frac{dy}{\varphi(y)} = \int f(x) \,dx + c \ \footnote{在ODE中此式代指一个函数，所以等式后加常数c；不同于数分中代指的是一族函数} $$
\indent \ding{173}若$\varphi(y_{0}) = 0$，则有特解
$$y = y_{0}$$
综上：$
\begin{cases}
    G(y) = F(x) + C \\
    y \equiv y_{i} , i = 1,2,\dots,k
\end{cases}$

\textbf{注：}变量分离方程可能是线性($\dfrac{dy}{dx} = xy$)，也可能是非线性($\dfrac{dy}{dx} = xy^{2}$)
\\ \hspace*{\fill} \\
\noindent \pmb{例2：}求以下方程通解
$$\frac{dy}{dx} =P(x)y$$
\pmb{解：}
\ding{172}若$\varphi(y) \neq 0$，则有
$$\frac{dy}{y} = P(x)dx$$
\indent 两边同时积分得
$$\ln \left\lvert y\right\rvert = \int P(x) \,dx + \overline{c} $$
\indent 通解为
$$\left\lvert y \right\rvert = e^{\int \limits P(x) \,dx + \overline{c}}$$
\indent 即
$$y = \pm e^{\overline{c}} \cdot e^{\int \limits P(x) \,dx } = ce^{\int \limits P(x) \,dx } \quad  (c = \pm e^{\overline{c} })$$
\indent \ding{173}若$\varphi(y_{0}) = 0$，则上式$c = 0$

\indent 故方程的解为\textcolor{red}{$y = ce^{\int \limits P(x) \,dx }$}，其中$c$为任意常数
\\ \hspace*{\fill} \\
\noindent \pmb{例2 \ PPT：}求解方程$\dfrac{dy}{dx} = y^{2} \cos x$，并求出满足初始条件：当$x = 0$时$y = 1$的特解

\noindent \pmb{解：}
$y \neq 0$时
分离变量有
$$\frac{dy}{y^{2}} = \cos x dx$$
\indent 两边同时积分得
$$\int \dfrac{dy}{y^{2}} = \int \cos x dx + c - \frac{1}{y} = \sin x + c$$
\indent 通解为
$$y = -\dfrac{1}{\sin x + c}$$
\indent 且$y = 0$也是方程解，

故原方程的解为$$
\begin{cases}
    y = -\dfrac{1}{\sin x + c} \\
    y \equiv 0
\end{cases}
$$
\indent 将初始条件$y(0) = 1$代入通解，得$c = -1$

\indent 则满足所给条件的特解为$y = -\dfrac{1}{\sin x + c}$

\subsection*{可化为变量分离方程的类型}
\noindent \pmb{(1)齐次微分方程：}

\noindent \textbf{定义：}方程形如$$\dfrac{dy}{dx} = g\left(\dfrac{y}{x}\right) $$

\noindent \textbf{求解步骤：}

作变量变换
$$u = \frac{y}{x}$$
\indent 两边同时求导得：
$$\frac{dy}{dx} = x \frac{du}{dx} + u$$
\indent 代入上式有
$$\frac{du}{dx} = \frac{g(u) - u}{x}$$
\indent 下用变量分离的方法求解

\textbf{注：}齐次微分方程可能是线性($\dfrac{dy}{dx} = \dfrac{y}{x}$)，也可能是非线性($\dfrac{dy}{dx} = \dfrac{y^{2}}{x^{2}}$)
\\ \hspace*{\fill} \\
\pmb{例4：}解方程
$$\frac{dy}{dx} = \frac{y}{x} + \tan \dfrac{y}{x}$$
\pmb{解：}
作变量变换
$$u = \frac{y}{x}$$
\indent 两边同时求导得
$$\frac{dy}{dx} = x \frac{du}{dx} + u$$
\indent 代入题给方程得
$$x \frac{du}{dx} = \tan u$$
\indent 若$\tan u \neq 0$，分离变量有
$$\cot u du = \frac{dx}{x}$$
$$\frac{d \sin u}{\sin u} = \frac{dx}{x}$$
\indent 两边同时求导得：
$$\ln \left\lvert \sin u\right\rvert = \ln \left\lvert x\right\rvert + \overline{c} $$
\indent 即有
$$\sin u = \pm e^{\overline{c}} \cdot x$$
\indent 令$\pm e^{\overline{c}} = c$，即有
$$\sin u = cx$$
\indent 若$\tan u = 0$，当$c = 0$时满足，为方程特解

综上，原方程的通解为$\sin \dfrac{y}{x} = cx$
\\ \hspace*{\fill} \\
\noindent \pmb{(2)形如：}
$$\dfrac{dy}{dx} = f(ax + by + c) \quad (a \neq 0 , b \neq 0)$$
\textbf{求解步骤：}

\indent 作变量变换
$$u = ax + by + c$$
\indent 两边对$x$求导
$$\frac{du}{dx} = a + b\frac{dy}{dx}$$
\indent 代回原方程得
$$\frac{du}{dx} = a + bf(u)$$
\\ \hspace*{\fill} \\
\noindent \pmb{例6：}解方程
$$\dfrac{dy}{dx} = (x + y)^{2}$$

\noindent \pmb{解：}

作变量变换
$$u = x + y$$
\indent 两边同时对$x$求导得
$$\dfrac{du}{dx} = 1 + \dfrac{dy}{dx}$$
\indent 代回原方程得
$$\dfrac{du}{dx} = 1 + u^{2}$$
\indent 分离变量有
$$\dfrac{du}{1 + u^{2}} = dx \Rightarrow \int \frac{du}{1 + u^{2}} = \int dx + c \Rightarrow \arctan u = x + c$$
\indent 将$u = x + y$代回原方程得
$$\arctan(x + y) = x + c$$
\\ \hspace*{\fill} \\
\noindent \pmb{(3)形如：}
$$\dfrac{dy}{dx} = f\left(\frac{a_{1}x + b_{1}y + c_{1}}{a_{2}x + b_{2}y + c_{2}}\right) $$
\ding{172}当$c_{1} = c_{2} = 0 $
$$\frac{dy}{dx} = f\left(\frac{a_{1} + b_{1}\dfrac{y}{x}}{a_{2} + b_{2}\dfrac{y}{x}}\right) = g\left(\dfrac{y}{x}\right)$$
为齐次微分方程

\ding{173}当$c_{1}$与$c_{2}$不同时为$0$

思路：
$$
\begin{cases}
    \overline{X} = x + A \\ 
    \overline{Y} = y + B  
\end{cases} 
\Rightarrow f\left(\frac{a_{1}\overline{X} + b_{1}\overline{Y}}{a_{2}\overline{X} + b_{2}\overline{Y}} \right) = \frac{d\overline{Y} }{d\overline{X} }$$
$$
\begin{cases}
    d\overline{X} = dx \\
    d\overline{Y} = dy  
\end{cases}$$

观察：$
\begin{cases}
    a_{1}x + b_{1}y + c_{1} = 0 \\
    a_{2}x + b_{2}y + c_{2} = 0
\end{cases}$

1>当$
\begin{vmatrix}
    a_{1} & b_{1} \\
    a_{2} & b_{2}
\end{vmatrix} \neq 0 $
，有唯一解：$
\begin{cases}
    x = \alpha \\
    y = \beta
\end{cases}$

设
$$
\begin{cases}
    \overline{X} = x - \alpha \\ 
    \overline{Y} = y - \beta  
\end{cases}$$
\indent 故有
$$
\begin{cases}
    c_{1} = -a_{1}\alpha - b_{1}\beta \\
    c_{2} = -a_{2}\alpha - b_{2}\beta 
\end{cases} \Rightarrow
f\left(\frac{a_{1}x + b_{1}y + c_{1}}{a_{2}x + b_{2}y + c_{2}}\right) = f\left(\frac{a_{1}\overline{X} + b_{1}\overline{Y}}{a_{2}\overline{X} + b_{2}\overline{Y}} \right) = \frac{d\overline{Y} }{d\overline{X} }$$

2>当$
\begin{vmatrix}
    a_{1} & b_{1} \\
    a_{2} & b_{2}
\end{vmatrix} = 0 $

(\romannumeral 1)

\quad $\begin{array}{l}
    a_{1} = b_{1} = 0 \Rightarrow \dfrac{dy}{dx} = f\left(\dfrac{c_{1}}{a_{2}x + b_{2}y + c_{2}}\right) \\
    a_{2} = b_{2} = 0 \Rightarrow \dfrac{dy}{dx} = f\left(\dfrac{a_{1}x + b_{1}y + c_{1}}{c_{2}}\right)
\end{array}$

(\romannumeral 2)

\quad $\begin{array}{l}
    a_{1} = a_{2} = 0 \Rightarrow f\left(\dfrac{b_{1}y + c_{1}}{b_{2}y + c_{2}}\right) \\

b_{1} = b_{2} = 0 \Rightarrow \dfrac{dy}{dx} = f\left(\dfrac{a_{1}x + c_{1}}{a_{2}x + c_{2}}\right) 
\end{array} \quad \Rightarrow $变量分离

(\romannumeral 3)

\quad $\dfrac{a_{1}}{a_{2}} = \dfrac{b_{1}}{b_{2}} = k $
令$u = a_{2}x + b_{2}y$，此时$\dfrac{du}{dx} = a_{2} + b_{2}\dfrac{dy}{dx}$

\quad $\dfrac{dy}{dx} = f\left(\dfrac{k(a_{2}x + b_{2}y) + c_{1}}{(a_{2}x + b_{2}y) + c_{2}}\right) = f\left(\dfrac{ku + c_{1}}{u + c_{2}}\right) = g(u)$

\quad $\dfrac{du}{dx} = a_{2} + b_{2}g(u)$ 
\\ \hspace*{\fill} \\
\noindent \pmb{例7：}解微分方程$$\dfrac{dy}{dx} = \dfrac{x - y + 1}{x + y - 3}$$

\noindent \pmb{解：}
代数方程$$
\begin{cases}
    x - y + 1 = 0 \\
    x + y - 3 = 0
\end{cases}$$

求解$$\begin{vmatrix}
    1 & -1 \\
    1 & 1
\end{vmatrix} = 2 \neq 0 
\Rightarrow 
\begin{cases}
    x = 1 \\
    y = 2
\end{cases}$$

令$$
\begin{cases}
    \overline{X} = x - 1 \\
    \overline{Y} = y - 2
\end{cases} $$

则有$$\dfrac{d\overline{Y}}{d\overline{X}} = \dfrac{d\overline{X} - d\overline{Y}}{d\overline{X} + d\overline{Y}} = \dfrac{1 - \dfrac{\overline{Y}}{\overline{X}}}{1 + \dfrac{\overline{Y}}{\overline{X}}}$$

上式为齐次微分方程，作变量变换

$$u = \dfrac{\overline{Y}}{\overline{X}} \Rightarrow \overline{Y} = u\overline{X}$$

上式两边同时对$\overline{X}$求导得
$$\dfrac{d\overline{Y}}{d\overline{X}} = \dfrac{du}{d\overline{X}}\overline{X} + u$$

故有
\begin{align*}
    & \dfrac{du}{d\overline{X}}\overline{X} + u = \dfrac{1 - u}{1 + u} \\
    & \dfrac{du}{d\overline{X}}\overline{X} = \dfrac{1 - u - u - u^{2}}{1 + u} = \dfrac{1 - 2u - u^{2}}{1 + u}
\end{align*}

当$1 - 2u - u^{2} \neq 0 $，则有
\begin{align*}
    & \dfrac{1 + u}{1 - 2u - u^{2}} du = \dfrac{d\overline{X}}{\overline{X}} \\
    & \dfrac{1}{2} \dfrac{d(u^{2} + 2u - 1)}{1 - 2u - u^{2}} = \dfrac{d\overline{X}}{\overline{X}} \\
    -&\dfrac{1}{2} \int \dfrac{d(u^{2} + 2u - 1)}{u^{2} + 2u - 1} = \int \dfrac{d\overline{X}}{\overline{X}} + c     
\end{align*}
$$\ln \overline{X}^{2} = -\ln\left\lvert u^{2} + 2u - 1\right\rvert + \overline{c}$$
$$\overline{X}^{2}(u^{2} + 2u - 1) = \pm e^{\overline{c}} = c_{1}$$

代入原函数有
$$\overline{Y}^{2} + 2\overline{X}\overline{Y} - \overline{X}^{2} = c_{1}$$
$$(y - 2)^{2} + 2(x - 1)(y - 2) - (x - 1)^{2} = c_{1}$$

此外，易知$1 - 2u - u^{2} = 0$，即有
$$\overline{Y}^{2} + 2\overline{X}\overline{Y} - \overline{X}^{2} = 0$$

也是方程解

此时只用通解$c_{1} = 0$，即可

故原式通解为
$$y^{2} + 2xy - x^{2} - 6y - 2x = c$$

$c$为任意常数
\\ \hspace*{\fill} \\
\noindent \pmb{例：}变量代换举例
$$(1)x^{2}\dfrac{dy}{dx} = f(xy)$$
$$(2)\dfrac{dy}{dx} = xf\left(\dfrac{y}{x^{2}}\right) $$

(1)$u = xy \Rightarrow x\dfrac{du}{dx} = x + x^{2}\dfrac{dy}{dx} \Rightarrow x\dfrac{du}{dx} = x + f(u)$

(2)$u = \dfrac{y}{x^{2}} \Rightarrow (y = ux^{2}) \Rightarrow \dfrac{dy}{dx} = \dfrac{du}{dx}x^{2} + 2ux = xf(u)$

\newpage
% ------------------2.2---------------------
\section{线性微分方程与常数变易法}
\noindent \pmb{概念：}
\textbf{一阶线性微分方程}
$$\dfrac{dy}{dx} = P(x)y + Q(x)$$

\quad \textbf{一阶齐次线性微分方程}，$Q(x) = 0$
$$\dfrac{dy}{dx} = P(x)y $$

\quad \quad \quad 通解\textcolor{red}{$y = ce^{\int P(x) dx}$}


\quad \textbf{一阶非齐次线性微分方程}，$Q(x) \neq 0$
$$\dfrac{dy}{dx} = P(x)y + Q(x)$$


\noindent \pmb{求解步骤：}

\textbf{常数变易法}：将齐次微分方程中常数$c$变易为$x$的待定系数$c(x)$的方法

已知
$$y = c(x)e^{\int P(x) dx}$$

求导得
\begin{align*}
    y' & = \left(c(x)e^{\int P(x) dx}\right)' \\
    & = c'(x)e^{\int P(x) dx} + c(x)e^{\int P(x) dx}P(x)
\end{align*}

一阶线性方程求导
$$y' = P(x)y + Q(x) = P(x)c(x)e^{\int P(x) dx} + Q(x)$$

上面两个式子联立
$$y'= c'(x)e^{\int P(x) dx} + c(x)e^{\int P(x) dx}P(x) = P(x)c(x)e^{\int P(x) dx} + Q(x)$$

消去相同项有
$$c'(x)e^{\int P(x) dx} = Q(x)$$

即有
$$c'(x) = Q(x)e^{-\int P(x) dx} $$

两边同时积分得
$$c(x) = \int Q(x)e^{-\int P(x) dx} dx+ \overline{c}$$

将上式代入已知式子即得
\textcolor{red}{$$y = e^{\int P(x) dx}\left(\int Q(x)e^{-\int P(x) dx} dx+ \overline{c}\right) $$}

\noindent \pmb{例1：}解方程$(x + 1) \dfrac{dy}{dx} - ny = e^{x}(x + 1)^{n + 1}$

\noindent \pmb{解：}

将方程改写为
$$\frac{dy}{dx} = \frac{n}{x + 1}y + e^{x}(x + 1)^{n}$$

故
$$P(x) = \frac{n}{x + 1} \quad Q(x) = e^{x}(x + 1)^{n}$$

代入公式得
\begin{align*}
    y & = e^{\int \frac{n}{x + 1} dx}\left(\int e^{x}(x + 1)^{n} e^{-\int \frac{n}{x + 1} dx} dx + \overline{c}\right) \\
    & = \left\lvert x + 1 \right\rvert ^{n}\left(\int e^{x}(x + 1)^{n} \cdot \dfrac{1}{\left\lvert x + 1 \right\rvert ^{n}}dx + \overline{c}\right) 
\end{align*}

若$x + 1 > 0$
\begin{align*}
    y & = (x + 1)^{n}\left(\int e^{x}dx + \overline{c}\right) \\
    & = (x + 1)^{n}\left(e^{x} + \overline{c}\right)
\end{align*}

若$x + 1 < 0$
\begin{align*}
    y & = (-1)^{n}(x + 1)^{n}\left(\int (-1)^{n}e^{x}dx + \overline{c}\right) \\
    & = (x + 1)^{n}\left(e^{x} + (-1)^{n}\overline{c}\right)
\end{align*}

综上
$$ y = (x + 1)^{n}\left(e^{x} + \overline{c}\right)$$
\\ \hspace*{\fill} \\
\noindent \pmb{例2：}求方程$\dfrac{dy}{dx} = \dfrac{y}{2x - y ^{2}}$的通解，并求$y(0) = 2$时的特解

\noindent \pmb{解：}

原方程不是线性微分方程，若$y \neq 0$，方程可改写为
$$ \frac{dx}{dy} = \frac{2x - y^{2}}{y} = \frac{2x}{y} - y$$

故
$$P(y) = \frac{2}{y} \quad Q(y) = -y$$

公式应为
$$x = e^{\int P(y) dy}\left(\int Q(y) e^{-\int P(y) dy} + \overline{c}\right) $$

代入公式得
\begin{align*}
    x & = e^{\int \frac{2}{y}dy}\left(\int (-y)e^{-\int \frac{2}{y}dy} dy+ \overline{c}\right) \\
    & = \left\lvert y\right\rvert ^{2}\left(\int (-y)\frac{1}{\left\lvert y\right\rvert^{2} }dy + \overline{c}\right) \\
    & = y^{2}(\ln\left\lvert y\right\rvert + \overline{c})
\end{align*}

将$x = 0$，$y = 2$代入上式
$$0 = 4(-\ln 2 + \overline{c}) \Rightarrow \overline{c} = \ln 2$$

故特解为
$$x = y^{2}(\ln 2 - ln\left\lvert y\right\rvert )$$










\end{document}